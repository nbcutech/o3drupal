package net.findzen.io {	import flash.events.*	import flash.net.*;	import com.bigspaceship.utils.Out;		import com.adobe.serialization.json.*;		public class SendAndLoad extends EventDispatcher {		private var _request:URLRequest;		private var _loader:URLLoader;		private var _data:Object;		public function SendAndLoad($url:String, $vars:URLVariables = null) {			_request = new URLRequest($url);			_loader = new URLLoader();						if($vars) {				_data = new URLVariables();								_request.data = $vars;				_request.method = URLRequestMethod.POST;			}						_loader.addEventListener(Event.COMPLETE, _onLoaderComplete);			_loader.addEventListener(IOErrorEvent.IO_ERROR, _onIOError);			_loader.load(_request);		}				private function _onLoaderComplete($e:Event):void {			Out.debug(this, $e.target.data);						_data = JSON.decode($e.target.data);						dispatchEvent($e);						_close();		}				private function _onIOError($e:IOErrorEvent):void {			Out.error(this, $e);						dispatchEvent($e);						_close();		}				public function get data():Object {			return _data;		}				private function _close():void {			try {								_loader.removeEventListener(Event.COMPLETE, _onLoaderComplete);				_loader.close();				_loader = null;							} catch($error:Error) {								Out.error(this, "close: " + $error);							}		}	}}